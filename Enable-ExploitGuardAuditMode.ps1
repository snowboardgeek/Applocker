Write-Host "Enabling WD Exploit Guard scenarios in audit mode." -ForegroundColor Green

# Enable all Attack Surface Reducation rules in audit mode
Write-Host "Enabling Attack Surface Reducation rules and setting to audit mode"
Add-MpPreference -AttackSurfaceReductionRules_Ids 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84 -AttackSurfaceReductionRules_Actions AuditMode
Add-MpPreference -AttackSurfaceReductionRules_Ids 3B576869-A4EC-4529-8536-B80A7769E899 -AttackSurfaceReductionRules_Actions AuditMode
Add-MpPreference -AttackSurfaceReductionRules_Ids D4F940AB-401B-4EfC-AADC-AD5F3C50688A -AttackSurfaceReductionRules_Actions AuditMode
Add-MpPreference -AttackSurfaceReductionRules_Ids D3E037E1-3EB8-44C8-A917-57927947596D -AttackSurfaceReductionRules_Actions AuditMode
Add-MpPreference -AttackSurfaceReductionRules_Ids 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC -AttackSurfaceReductionRules_Actions AuditMode
Add-MpPreference -AttackSurfaceReductionRules_Ids BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550 -AttackSurfaceReductionRules_Actions AuditMode
Add-MpPreference -AttackSurfaceReductionRules_Ids 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B -AttackSurfaceReductionRules_Actions AuditMode

# Enable Controlled Folder Access in audit mode
Write-Host "Enabling Controlled Folder Access and setting to audit mode"
Set-MpPreference -EnableControlledFolderAccess AuditMode

# Enable Network Protection in audit mode
Write-Host "Enabling Network Protection and setting to audit mode"
Set-MpPreference -EnableNetworkProtection AuditMode

# Update to latest Windows Defender engine
Update-MpSignature

Write-Host "Successfully enabled Windows Defender Exploit Guard scenarios in audit mode." -ForegroundColor Green